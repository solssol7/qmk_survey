<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#ffffff" />
  <title>장보기 MBTI 테스트</title>

  <link rel="stylesheet" href="./assets/css/base.css" />
  <link rel="stylesheet" href="./assets/css/layout.css" />
  <link rel="stylesheet" href="./assets/css/components.css" />

  <style>
    /* 1. 뒤로가기 버튼 왼쪽 최상단 고정 & 제목 줄바꿈 방지 */
    .brandRow {
      position: relative; /* 버튼 배치를 위한 기준점 */
      justify-content: center; /* 제목은 중앙 정렬 */
    }
    .brandRow .iconBtn {
      position: absolute;
      left: 6px; /* 왼쪽 벽에 붙임 */
      top: 50%;
      transform: translateY(-50%); /* 세로 중앙 정렬 */
      z-index: 10;
    }
    .brandRow__title {
      word-break: keep-all; /* 단어 중간에서 줄바꿈 방지 */
      text-align: center;
      width: 70%; /* 제목 영역 확보 */
    }
    
    /* 2. 이미지가 없을 때 보이는 지저분한 텍스트 숨김 */
    .illusFallback { display: none !important; }
    
    /* 3. 이미지 박스 깔끔하게 (흰색 배경) */
    .illusBox {
      background-color: #ffffff !important; 
      border-bottom: 1px solid var(--line);
    }
    
    /* 4. 결과 페이지 데이터 박스 간격 */
    .result-data-box { margin-bottom: 12px; }
  </style>
</head>

<body>
  <div class="app">
    <main class="stage">
      <section class="card" aria-live="polite">

        <div id="viewIntro" class="view is-active">
          <div class="topline"></div>

          <header class="brandRow">
            <button class="iconBtn" type="button" aria-label="뒤로" disabled>←</button>
            <div class="brandRow__title">
              <div class="brandRow__kicker">나의 장보기 성향은?</div>
              <div class="brandRow__brand">장보기 MBTI 테스트</div>
            </div>
            <div class="brandRow__right" style="position:absolute; right:16px;">
              <span class="progressTiny">1 / 9</span>
            </div>
          </header>

          <div class="illusBox illusBox--wide">
            <img id="introImage" alt="" onerror="this.style.display='none';" />
          </div>

          <div class="introCopy">
            <h1 class="introTitle" style="word-break: keep-all;">1분만에 끝나는<br>장보기 성향 테스트</h1>
            <p class="introDesc">
              이미 매칭된 마트 기준으로<br />
              “무엇을 먼저 추천받아야 할지”를 찾아드려요.
            </p>
            <p id="uidNote" class="uidNote" style="display:none;"></p>
          </div>

          <div class="actions actions--stack">
            <button id="btnStart" class="btn btn--pillPrimary" type="button">테스트 시작!</button>
            <button id="btnDemo" class="btn btn--pillGhost" type="button" style="display:none;">(데모) 바로 결과 보기</button> 
          </div>

          <p class="footNote">
            * 본 테스트는 재미/추천 최적화를 위한 성향 분류이며,<br>실제 상품 구성은 매장별로 달라질 수 있어요.
          </p>
        </div>

        <div id="viewQuiz" class="view">
          <div class="topline"></div>

          <header class="brandRow">
            <button id="btnPrev" class="iconBtn" type="button" aria-label="이전">←</button>
            
            <div class="brandRow__title">
              <div class="brandRow__kicker">장보기 MBTI 테스트</div>
              <div class="brandRow__brand" id="quizTitleTop">질문</div>
            </div>
            
            <div class="brandRow__right" style="position:absolute; right:16px;">
              <span id="progressLabel" class="progressTiny">1 / 9</span>
            </div>
          </header>

          <div class="progressBar" role="progressbar" aria-valuemin="0" aria-valuemax="9" aria-valuenow="1">
            <div id="barFill" class="progressBar__fill"></div>
          </div>

          <div class="illusBox illusBox--wide">
            <img id="qImage" alt="" onerror="this.style.display='none';" />
          </div>

          <div class="questionBlock">
            <h2 id="qTitle" class="qTitle" style="word-break: keep-all;">질문 제목</h2>
            <p id="qHint" class="qHint" style="word-break: keep-all;">힌트 문구</p>
          </div>

          <div id="choices" class="choicePills" aria-label="선택지"></div>
        </div>

        <div id="viewResult" class="view">
          <div class="topline"></div>

          <header class="brandRow">
            <button id="btnBackFromResult" class="iconBtn" type="button" aria-label="처음으로">←</button>
            <div class="brandRow__title">
              <div class="brandRow__kicker">나의 장보기 성향은?</div>
              <div class="brandRow__brand">테스트 결과</div>
            </div>
            <div class="brandRow__right" style="position:absolute; right:16px;">
              <span class="progressTiny">완료</span>
            </div>
          </header>

          <div class="resultHead">
            <div class="resultBadgeLine">
              <span id="resultBadge" class="badge">나의 타입</span>
              <span id="resultCodeText" class="codePill">CODE</span>
            </div>

            <h2 id="resultTitle" class="resultTitle" style="word-break: keep-all;">타입명</h2>
            <p id="resultOne" class="resultOne" style="word-break: keep-all;">한 줄 소개</p>

            <p id="resultRateText" class="resultRate">
              전체 테스트 참여자 중 <b>00.00%</b>가 같은 유형입니다.
            </p>
          </div>

          <div class="illusBox illusBox--portrait">
            <img id="resultImage" alt="" onerror="this.style.display='none';" />
          </div>

          <div class="card__body stack">
            <div class="box result-data-box">
              <h3 class="h3">이런 점이 좋아요</h3>
              <div id="strengthChips" class="chips"></div>
            </div>

            <div class="box result-data-box">
              <h3 class="h3">이건 좀 주의해요</h3>
              <div id="riskChips" class="chips"></div>
            </div>

            <div class="box result-data-box">
              <h3 class="h3">추천 코너</h3>
              <div id="sectionChips" class="chips"></div>
            </div>

            <div class="box result-data-box">
              <h3 class="h3">예상 장바구니</h3>
              <div id="basketChips" class="chips"></div>
            </div>

            <div class="box result-data-box">
              <h3 class="h3">성향 분석표</h3>
              <div id="weightGrid" class="weights"></div>
            </div>
          </div>
          <div class="resultActions">
            <div class="saveHint">결과 화면을 캡처해서 저장해보세요!</div>
            <div class="actions actions--stack">
              <button id="btnCopy" class="btn btn--pillPrimary" type="button">링크 복사</button>
              <button id="btnSave" class="btn btn--pillGhost" type="button">내 타입 저장</button>
              <button id="btnRestart" class="btn btn--pillLight" type="button">다시 테스트</button>
            </div>
            <p class="shareUrlLine">
              <span class="shareLabel">공유 링크</span>
              <span id="shareUrl" class="shareUrl"></span>
            </p>
          </div>
        </div>

      </section>
    </main>
  </div>

  <script src="./assets/js/config.js"></script>
  <script src="./assets/js/utils.js"></script>
  <script src="./assets/js/supabase.js"></script>
  <script src="./assets/js/data.js"></script>
  <script src="./assets/js/quiz.js"></script>
  <script src="./assets/js/main.js"></script>
</body>
</html>
