<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#ffffff" />
  <title>ì¥ë³´ê¸° MBTI í…ŒìŠ¤íŠ¸</title>

  <script>
    (function() {
      // 1. ê¸€ë¡œë²Œ ë³€ìˆ˜ ì„¤ì •
      window.Airbridge = 'airbridge';
      
      // 2. ìŠ¤í…(Stub) ê°ì²´ ìƒì„±: ë¯¸ë¦¬ ëª…ë ¹ì„ ë°›ì•„ë‘˜ í(Queue) ìƒì„±
      window.airbridge = window.airbridge || { q: [] };

      // 3. ì£¼ìš” ë©”ì„œë“œ ë¯¸ë¦¬ ë§Œë“¤ì–´ë‘ê¸° (.init í˜¸ì¶œ ì‹œ ì—ëŸ¬ ë°©ì§€)
      ['init', 'createTrackingLink', 'track', 'events'].forEach(function(method) {
        window.airbridge[method] = window.airbridge[method] || function() {
          // SDK ë¡œë“œ ì „ í˜¸ì¶œëœ ëª…ë ¹ì€ íì— ì €ì¥
          window.airbridge.q.push([method].concat(Array.prototype.slice.call(arguments)));
        };
      });

      // 4. ì‹¤ì œ SDK ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ
      var script = document.createElement('script');
      script.src = 'https://static.airbridge.io/sdk/latest/airbridge.min.js';
      script.async = true;
      document.getElementsByTagName('head')[0].appendChild(script);
    })();
  </script>
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ì¥ë³´ê¸° MBTI í…ŒìŠ¤íŠ¸" />
  <meta property="og:description" content="1ë¶„ ë§Œì— ëë‚˜ëŠ” ë‚˜ì˜ ì¥ë³´ê¸° ì„±í–¥ ë¶„ì„! ë‚˜ì™€ ë”± ë§ëŠ” ë§ˆíŠ¸ ì‡¼í•‘ ìœ í˜•ì€?" />
  <meta property="og:image" content="https://mbti.event.qmarket.me/assets/img/intro/intro.webp" />
  <meta property="og:url" content="https://mbti.event.qmarket.me" />

  <link rel="stylesheet" href="./assets/css/base.css" />
  <link rel="stylesheet" href="./assets/css/layout.css" />
  <link rel="stylesheet" href="./assets/css/components.css" />

  <style>
    /* ... (ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€) ... */
    body { background-color: #f8f9fa; }
    .app {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    .stage { width: 100%; max-width: 500px; }

    /* ì¹´ë“œ ë””ìì¸ */
    .card {
      border: none !important;
      border-radius: 24px !important;
      box-shadow: 0 10px 40px rgba(0,0,0,0.08) !important;
      overflow: hidden;
      background: #ffffff;
    }

    /* í—¤ë” */
    .brandRow {
      border: none !important;
      height: 60px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .iconBtn {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      border: none !important;
      background: #f1f3f5 !important;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: #333;
      cursor: pointer;
      z-index: 10;
    }
    .brandRow__brand { 
      font-size: 18px; font-weight: 800; color: #333; 
      user-select: none; cursor: pointer; /* ì´ìŠ¤í„°ì—ê·¸ìš© */
    }
    .progressTiny { font-size: 14px; font-weight: 700; color: #adb5bd; }

    /* í”„ë¡œê·¸ë ˆìŠ¤ ë°” */
    .progressBarContainer { padding: 0 20px 10px; }
    .progressBar {
      height: 6px;
      background: #f1f3f5;
      border-radius: 99px;
      overflow: hidden;
      border: none !important;
    }
    .progressBar__fill {
      height: 100%;
      background: linear-gradient(90deg, #FF6B6B, #FF8E53);
      transition: width 0.3s ease;
    }

    /* ë²„íŠ¼ & ì•¡ì…˜ */
    .actions {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .btn {
      border: none !important;
      border-radius: 16px !important;
      font-weight: 700 !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      transition: transform 0.1s;
      padding: 0 32px;
      cursor: pointer;
    }
    .btn:active { transform: scale(0.97); }
    .btn--pillPrimary {
      background: linear-gradient(135deg, #FF6B6B, #FF8E53) !important;
      color: white !important;
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4) !important;
    }
    .btn--pillGhost { background: #f1f3f5 !important; color: #495057 !important; }
    .btn--pillGhost2 { background: #fff !important; color: #495057 !important; border: 1px solid #dee2e6 !important;}
    .btn--half { flex: 1; padding: 0 16px; min-width: 120px; }

    /* ì„ íƒì§€ ë²„íŠ¼ */
    .choicePill {
      border: 1px solid #e9ecef !important;
      background: #fff !important;
      border-radius: 16px !important;
      box-shadow: 0 2px 8px rgba(0,0,0,0.03);
      color: #333;
      transition: all 0.2s;
      display: flex !important;
      flex-direction: column !important;
      justify-content: center !important;
      align-items: center !important;
      text-align: center;
      line-height: 1.3;
    }
    .choicePill:hover {
      border-color: #FF8E53 !important;
      background: #fff7ed !important;
    }

    /* ì´ë¯¸ì§€ ë°•ìŠ¤ */
    .illusBox {
      background: #f8f9fa !important;
      border-radius: 16px;
      margin: 0 20px;       
      width: auto !important; 
      aspect-ratio: 16/9;
      border: none !important;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    img[src=""], img:not([src]) { display: none; } 
    .illusFallback { display: none !important; }

    /* í…ìŠ¤íŠ¸ ìœ í‹¸ */
    h1, h2, h3, p { word-break: keep-all; letter-spacing: -0.02em; }
    
    /* ê²°ê³¼ í˜ì´ì§€ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
    .result-box {
      background: #f8f9fa;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 12px;
      text-align: center;
    }
    .chips { display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; }
    .chip {
      background: #fff !important;
      border: 1px solid #dee2e6 !important;
      color: #495057 !important;
      border-radius: 8px !important;
      padding: 6px 12px !important;
      font-size: 14px;
      font-weight: 600;
    }

    /* í† ìŠ¤íŠ¸ */
    .toast {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: rgba(0,0,0,0.85);
      color: #fff;
      padding: 12px 24px;
      border-radius: 30px;
      font-size: 14px;
      font-weight: 700;
      opacity: 0;
      transition: all 0.3s ease;
      pointer-events: none;
      z-index: 9999;
      white-space: nowrap;
    }
    .toast.is-show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* ë¡œë”© ìŠ¤í”¼ë„ˆ ì• ë‹ˆë©”ì´ì…˜ */
    .spinner {
      width: 48px;
      height: 48px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #FF6B6B;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body>
  <button id="btnDebugInfo" style="
      display: none; 
      position: fixed; 
      top: 150px; right: 20px; z-index: 999999; 
      background: #ff0000; color: #fff; 
      border: 2px solid #fff; border-radius: 50px; 
      padding: 10px 15px; font-weight: bold; font-size: 14px; 
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
  ">
    DEBUG ğŸ
  </button>

  <div id="debugConsole" style="
      display: none; 
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8); z-index: 9999999;
      padding: 40px 20px; box-sizing: border-box;
      overflow-y: auto; color: #00ff00; font-family: monospace; font-size: 14px;
  ">
    <div style="background:#222; padding:20px; border-radius:10px; border:1px solid #444;">
      <h3 style="margin-top:0; color:#fff;">ğŸ DEBUG INFO</h3>
      <div id="debugText" style="white-space: pre-wrap; word-break: break-all; line-height: 1.6;"></div>
      <button id="btnCloseDebug" style="
          margin-top: 20px; width: 100%; padding: 15px; 
          background: #fff; color: #000; font-weight: bold; border: none; border-radius: 8px;
      ">ë‹«ê¸°</button>
    </div>
  </div>

  <div class="app">
    <main class="stage">
      <section class="card" aria-live="polite">

        <div id="viewIntro" class="view is-active">
          <header class="brandRow">
            <button class="iconBtn" type="button" aria-label="ë’¤ë¡œ" disabled>â†</button>
            <div class="brandRow__brand">ì¥ë³´ê¸° ì„±í–¥ í…ŒìŠ¤íŠ¸</div>
          </header>

          <div class="progressBarContainer">
            <div class="progressBar"><div class="progressBar__fill" style="width: 0%;"></div></div>
          </div>

          <div class="illusBox">
            <img id="introImage" src="./assets/img/intro/intro.webp" alt="" style="width:100%; height:100%; object-fit:contain;" onerror="this.style.display='none';" />
          </div>

          <div class="introCopy" style="padding: 30px 20px; text-align: center;">
            <h1 class="introTitle" style="font-size: 26px; margin-bottom: 12px; color: #111;">1ë¶„ ë§Œì— ëë‚˜ëŠ”<br>ì¥ë³´ê¸° MBTI í…ŒìŠ¤íŠ¸</h1>
            <p class="introDesc" style="font-size: 16px; color: #666; line-height: 1.6;">
              ìì£¼ ê°€ëŠ” ë§ˆíŠ¸ì—ì„œ<br />
              â€œë‚˜ì—ê²Œ ë”± ë§ëŠ” ì¶”ì²œâ€ì„ ì°¾ì•„ë“œë ¤ìš”.
            </p>
          </div>

          <div class="actions actions--stack" style="padding: 0 20px 30px; justify-content: center;">
            <button id="btnStart" class="btn btn--pillPrimary" type="button">í…ŒìŠ¤íŠ¸ ì‹œì‘í•˜ê¸°</button>
          </div>
        </div>

        <div id="viewQuiz" class="view">
          <header class="brandRow">
            <button id="btnPrev" class="iconBtn" type="button" aria-label="ì´ì „">â†</button>
            <div class="brandRow__brand">ì§ˆë¬¸</div>
            <div style="position:absolute; right:20px;">
              <span id="progressLabel" class="progressTiny">1 / 10</span>
            </div>
          </header>

          <div class="progressBarContainer">
            <div class="progressBar"><div id="barFill" class="progressBar__fill" style="width: 10%;"></div></div>
          </div>

          <div class="questionBlock" style="margin-top:10px; text-align: center;">
            <h2 id="qTitle" class="qTitle" style="font-size:22px; margin-bottom:8px;">ì§ˆë¬¸ ì œëª©</h2>
            <p id="qHint" class="qHint" style="font-size:15px; color:#868e96;">íŒíŠ¸ ë¬¸êµ¬</p>
          </div>

          <div class="illusBox" style="margin-top: 10px;">
            <img id="qImage" alt="" style="width:100%; height:100%; object-fit:contain;" onerror="this.style.display='none';" />
          </div>

          <div id="choices" class="choicePills" style="padding: 20px;"></div>
        </div>

        <div id="viewLoading" class="view">
          <div style="height: 400px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;">
            <div class="spinner"></div>
            <h2 style="font-size: 20px; color: #333; margin-bottom: 8px;">ê²°ê³¼ ë¶„ì„ ì¤‘...</h2>
            <p style="font-size: 15px; color: #868e96;">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš” ğŸ›’</p>
          </div>
        </div>

        <div id="viewResult" class="view">
          <header class="brandRow">
            <button id="btnBackFromResult" class="iconBtn" type="button" aria-label="ì²˜ìŒìœ¼ë¡œ">â†</button>
            <div class="brandRow__brand">í…ŒìŠ¤íŠ¸ ê²°ê³¼</div>
          </header>

          <div class="progressBarContainer">
            <div class="progressBar"><div class="progressBar__fill" style="width: 100%;"></div></div>
          </div>

          <div class="resultHead" style="padding: 20px; text-align: center;">
            <div class="resultBadgeLine" style="margin-bottom:12px;">
              <span id="resultBadge" style="background:#fff0f6; color:#c02b5e; padding:4px 8px; border-radius:6px; font-size:12px; font-weight:700;">MY TYPE</span>
              <span id="resultCodeText" style="display:none;"></span>
            </div>

            <h2 id="resultTitle" class="resultTitle" style="font-size:26px; color:#111; margin-bottom:8px;">íƒ€ì…ëª…</h2>
            <p id="resultOne" class="resultOne" style="font-size:16px; color:#495057;">í•œ ì¤„ ì†Œê°œ</p>

            <p id="resultRateText" class="resultRate" style="font-size:13px; color:#868e96; margin-top:10px;">
              ì°¸ì—¬ì ì¤‘ <b>00.00%</b>ê°€ ê°™ì€ ìœ í˜•ì…ë‹ˆë‹¤.
            </p>
          </div>

          <div class="illusBox illusBox--portrait" style="background:transparent !important; aspect-ratio: auto !important; width: auto !important;">
            <img id="resultImage" alt="" style="width:100%; border-radius:16px;" onerror="this.style.display='none';" />
          </div>

          <div class="card__body stack" style="padding:20px;">
            <div class="result-box" style="background:#f1f3f5; padding: 16px;">
              <h3 class="h3" style="font-size:16px; margin-bottom:12px;">â¤ï¸ ìš°ë¦¬ ì¥ë³´ê¸° ê¶í•©ì€?</h3>
              <div style="display:flex; gap:12px;">
                <div style="flex:1;">
                  <div style="font-size:12px; color:#16a34a; font-weight:700; margin-bottom:6px;">í™˜ìƒì˜ ì§ê¿ ğŸ¥°</div>
                  <div id="partnerBest" style="height:120px;"></div>
                </div>
                <div style="flex:1;">
                  <div style="font-size:12px; color:#e11d48; font-weight:700; margin-bottom:6px;">í™˜ì¥ì˜ ì§ê¿ ğŸ¤¯</div>
                  <div id="partnerWorst" style="height:120px;"></div>
                </div>
              </div>
            </div>

            <div class="result-box">
              <h3 class="h3" style="font-size:16px; margin-bottom:10px;">ğŸ‘ ì´ëŸ° ì ì´ ì¢‹ì•„ìš”</h3>
              <div id="strengthChips" class="chips"></div>
            </div>
            <div class="result-box">
              <h3 class="h3" style="font-size:16px; margin-bottom:10px;">âš ï¸ ì´ê±´ ì¢€ ì£¼ì˜í•´ìš”</h3>
              <div id="riskChips" class="chips"></div>
            </div>
            <div class="result-box">
              <h3 class="h3" style="font-size:16px; margin-bottom:10px;">ğŸ›’ ì¶”ì²œ ì½”ë„ˆ</h3>
              <div id="sectionChips" class="chips"></div>
            </div>
            <div class="result-box">
              <h3 class="h3" style="font-size:16px; margin-bottom:10px;">ğŸ›ï¸ ì˜ˆìƒ ì¥ë°”êµ¬ë‹ˆ</h3>
              <div id="basketChips" class="chips"></div>
            </div>
            <div id="weightGrid" class="weights" style="display:none;"></div>
          </div>

          <div class="resultActions" style="padding: 0 20px 30px;">
            <div class="actions actions--stack" style="justify-content: center;">
              
              <button id="btnShare" class="btn btn--pillPrimary" type="button" style="width: 100%;">
                âœ¨ ê²°ê³¼ ê³µìœ í•˜ê¸°
              </button>

              <button id="btnCopy" class="btn btn--pillGhost" type="button" style="width:100%; background:#fff !important; color:#FF6B6B !important; border:1px solid #ffccb0 !important;">
                ğŸ”— ë§í¬ ë³µì‚¬í•˜ê¸°
              </button>
              
              <button id="btnRestart" class="btn btn--pillGhost" type="button" style="width:100%; background:#f8f9fa !important; border:none !important; color:#868e96 !important; font-size: 14px; margin-top: 10px;">
                ğŸ”„ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°
              </button>

            </div>
            <input id="shareUrl" class="shareUrl" style="opacity:0; position:absolute; pointer-events:none;" />
          </div>

        </div>

      </section>
    </main>
    <div id="toast" class="toast"></div>
  </div>

  <script src="./assets/js/config.js"></script>
  <script src="./assets/js/utils.js"></script>
  <script src="./assets/js/supabase.js"></script>
  <script src="./assets/js/data.js"></script>
  <script src="./assets/js/quiz.js"></script>
  <script src="./assets/js/main.js"></script>
  
  <script>
    // [ë¹„ë°€ ê¸°ëŠ¥] í—¤ë” íƒ€ì´í‹€ 5ë²ˆ ì—°ì† íƒ­í•˜ë©´ ë””ë²„ê·¸ ë²„íŠ¼ í™œì„±í™”
    (function(){
      let debugClicks = 0;
      let debugTimer = null;
      
      const brands = document.querySelectorAll(".brandRow__brand");
      brands.forEach(el => {
        el.addEventListener("click", () => {
          debugClicks++;
          if (debugTimer) clearTimeout(debugTimer);

          // 0.5ì´ˆ ì•ˆì— ë‹¤ìŒ í´ë¦­ì´ ì—†ìœ¼ë©´ ë¦¬ì…‹
          debugTimer = setTimeout(() => {
            debugClicks = 0;
          }, 500);

          // 5ë²ˆ ì—°ì† í´ë¦­ ì‹œ ë²„íŠ¼ ë³´ì´ê¸°
          if (debugClicks >= 5) {
            const btn = document.getElementById("btnDebugInfo");
            if(btn) {
              btn.style.display = "block";
              alert("ğŸ ë””ë²„ê·¸ ëª¨ë“œê°€ ì¼œì¡ŒìŠµë‹ˆë‹¤!");
            }
            debugClicks = 0;
          }
        });
      });
    })();

    // [ê¸°ì¡´] ë””ë²„ê¹… ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    document.getElementById("btnDebugInfo").addEventListener("click", () => {
      const url = window.location.href;
      const search = window.location.search;
      const hash = window.location.hash;
      const ua = navigator.userAgent;
      
      let uid = "NULL";
      try {
        const params = new URLSearchParams(search);
        uid = params.get("user_id");
      } catch(e) { uid = "ERROR"; }

      const log = 
        "[1] URL:\n" + url + "\n\n" +
        "[2] Search(?):\n" + (search || "(EMPTY)") + "\n\n" +
        "[3] Hash(#):\n" + (hash || "(EMPTY)") + "\n\n" +
        "[4] user_id:\n" + (uid || "NULL (ì¸ì‹ì‹¤íŒ¨)") + "\n\n" +
        "[5] UA:\n" + ua;

      document.getElementById("debugText").textContent = log;
      document.getElementById("debugConsole").style.display = "block";
    });

    document.getElementById("btnCloseDebug").addEventListener("click", () => {
      document.getElementById("debugConsole").style.display = "none";
    });
  
    // ë’¤ë¡œê°€ê¸° í•¸ë“¤ëŸ¬
    document.addEventListener("DOMContentLoaded", () => {
      const btnBack = document.getElementById("btnBackFromResult");
      if(btnBack) {
        btnBack.addEventListener("click", () => {
          if(window.Quiz && window.Quiz.showIntro) {
            window.Quiz.showIntro();
            history.replaceState(null, "", location.pathname + location.search);
          } else {
            location.reload(); 
          }
        });
      }
    });
  </script>
</body>
</html>
